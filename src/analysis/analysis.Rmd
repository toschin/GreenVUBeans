---
title: "Analysis of Test Results"
author: "Team GreenBeans"
date: "2023-09-08"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, results = "hide",fig.show = 'hide'  )
```

```{r}
library(tidyverse)
library(car)
```

```{r}
data <- read.csv("../../data/processed/data.csv")
data
```

## Convert columns to factor and numeric type

```{r}
data$concat <- as.factor(data$concat)
data$queue_limit <- as.factor(data$queue_limit)
data$ncores <- as.factor(data$ncores)
data$ConsumedEnergy <- as.numeric(gsub("K", "e3", data$ConsumedEnergy))


# HH:MM:SS is converted into an integer of seconds
data$Elapsed <- sapply(strsplit(data$Elapsed,":"),
  function(x) {
    x <- as.numeric(x)
    x[1]*3600+x[2]*60+x[3]
    }
)
```

## Select data of mode HPC
```{r}
data_hpc <- data %>%
  filter(mode == "hpc")
```

```{r}
data_hpc
```

```{r}
ggplot(data_hpc, aes(x = ConsumedEnergy)) + 
  geom_histogram()
qqPlot(data_hpc$ConsumedEnergy)
```


```{r}
ggplot(data_hpc, aes(x = ConsumedEnergy)) + 
  geom_histogram() + 
  facet_grid(queue_limit ~ concat, labeller=label_both, scales = "free")
```

```{r}
ggplot(data_hpc, aes(x = Elapsed)) + 
  geom_histogram() + 
  facet_grid(queue_limit ~ concat, labeller=label_both, scales='free')
```



```{r}
ggplot(data_hpc, aes(x=concat, y=ConsumedEnergy, fill=concat)) + geom_boxplot() +
  stat_summary(fun = mean,color= 'red', geom = "point", shape = 1, size = 2) +
  labs(title="Box Plots",
  x="concat",
  y="Energy consumed") 
```

```{r}
violin <- ggplot(data_hpc, aes(x=concat, y=ConsumedEnergy, fill=concat)) +
          geom_violin(trim=FALSE, alpha = 0.8) + # alpha for the opacity
          geom_boxplot(width=0.2, fill="white", outlier.size = 0.2) +
          stat_summary(fun = mean, geom = "point", shape = 1, size = 2) +
          labs(title="Violin Plot",
          x="concat",
          y="Energy consumed") 
violin
```

## Graphical summary of Runtime

```{r}
ggplot(data_hpc, aes(x=concat, y=Elapsed, fill=concat)) + geom_boxplot() +
  stat_summary(fun = mean,color= 'red', geom = "point", shape = 1, size = 2) +
  labs(title="Box Plots",
  x="concat",
  y="Runtime") 
```

```{r}
ggplot(data_hpc, aes(x=concat, y=Elapsed, fill=concat)) +
          geom_violin(trim=FALSE, alpha = 0.8) + # alpha for the opacity
          geom_boxplot(width=0.2, fill="white", outlier.size = 0.2) +
          stat_summary(fun = mean, geom = "point", shape = 1, size = 2) +
          labs(title="Violin Plot of runtime",
          x="concat",
          y="Runtime") 
```

